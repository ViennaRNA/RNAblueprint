<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RNAblueprint-1.2.1: RNAblueprint library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rnablueprint-icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RNAblueprint-1.2.1
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('index.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">RNAblueprint library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>The RNAblueprint library solves the problem of stochastically sampling RNA/DNA sequences compatible to multiple structural constraints. It only creates sequences that fulfill all base pairs specified in any given input structure. Furthermore, it is possible to specify sequence constraints in IUPAC notation. Solutions are sampled uniformly from the whole solution space, therefore it is guaranteed, that there is no bias towards certain sequences.</p>
<p>The library is written in C++ with SWIG scripting interfaces for Python and Perl. Please cite the software as specified at the bottom of the page!</p>
<h1><a class="anchor" id="dependency_sec"></a>
Dependencies</h1>
<p>Required:</p><ul>
<li>GNU Automake</li>
<li>Boost Graph Library</li>
<li>C++ Standard Library</li>
</ul>
<p>Optional:</p><ul>
<li>Boost Programm Options (default: on)</li>
<li>SWIG for interfaces (default: on)</li>
<li>Python for interface (default: on)</li>
<li>Perl for interface (default: on)</li>
<li>ExtUtils::Embed module for perl interface (default: on)</li>
<li>Doxygen for documentation</li>
<li>LaTeX for PDF documentation</li>
<li>libGMP for multiprecision integers</li>
<li>openmp for parallel computation</li>
<li>Boost Unit Test Framework</li>
</ul>
<h1><a class="anchor" id="install_sec"></a>
Installation</h1>
<p>Just call these commands:</p>
<p>./autogen.sh<br />
./configure<br />
make<br />
make install<br />
 In case of a local installation, please do not forget to adopt your path variables such as <code>PATH</code>, <code>LD_LIBRARY_PATH</code>, <code>CPLUS_INCLUDE_PATH</code>, <code>PYTHONPATH</code>, <code>PERL5LIB</code></p>
<p>Most important configure options are:</p><ul>
<li>--prefix Specify an installation path prefix</li>
<li>--with-boost Specify the installation directory of the boost library</li>
<li>--disable-program Disable RNAblueprint program compilation</li>
<li>--disable-swig Disable all SWIG scripting interfaces</li>
<li>--enable-libGMP Enable the calculation of big numbers with multiprecision</li>
<li>--disable-openmp Disable the usage of parallel computation</li>
</ul>
<p>TIP: You might want call <code>./configure --help</code> for all install options!</p>
<h1><a class="anchor" id="examples_sec"></a>
Interface Examples</h1>
<h2><a class="anchor" id="python_ex"></a>
Python example</h2>
<div class="fragment"><div class="line"><span class="comment">#!/usr/bin/python</span></div><div class="line"><span class="comment"># This script is an example implementation on how to use the Python</span></div><div class="line"><span class="comment"># interface. It generates 1000 neighbors of an initially sampled</span></div><div class="line"><span class="comment"># random sequence.</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> RNAblueprint <span class="keyword">as</span> rd</div><div class="line"></div><div class="line"><span class="comment"># define structures</span></div><div class="line">structures = [<span class="stringliteral">&#39;(((((....)))))&#39;</span>, <span class="stringliteral">&#39;(((....)))....&#39;</span>]</div><div class="line"><span class="comment"># construct dependency graph with these structures</span></div><div class="line">dg = rd.DependencyGraphMT(structures)</div><div class="line"></div><div class="line"><span class="comment"># print this sequence</span></div><div class="line"><span class="keywordflow">print</span> dg.get_sequence()</div><div class="line"></div><div class="line"><span class="comment"># mutate globally for 1000 times and print</span></div><div class="line"><span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0, 1000):</div><div class="line">    dg.sample_clocal()</div><div class="line">    <span class="keywordflow">print</span> dg.get_sequence()</div><div class="line">    <span class="comment"># revert to the previous sequence</span></div><div class="line">    dg.revert_sequence();</div><div class="line"></div><div class="line"><span class="comment"># print the amount of solutions</span></div><div class="line"><span class="keywordflow">print</span> <span class="stringliteral">&#39;Maximal number of solutions: &#39;</span> + str(dg.number_of_sequences())</div><div class="line"><span class="comment"># print the amount of connected components</span></div><div class="line"><span class="keywordflow">print</span> <span class="stringliteral">&#39;Number of Connected Components: &#39;</span> + str(dg.number_of_connected_components())</div><div class="line"></div><div class="line"><span class="comment"># make a deep copy of the dependency graph</span></div><div class="line">dg1 = rd.DependencyGraphMT(dg)</div></div><!-- fragment --> <h2><a class="anchor" id="perl_ex"></a>
Perl example</h2>
<div class="fragment"><div class="line">#!/usr/bin/perl</div><div class="line"># This script is an example implementation on how to use the Perl</div><div class="line"># interface. It generates 1000 neighbors of an initially sampled</div><div class="line"># random sequence.</div><div class="line"></div><div class="line">use RNAblueprint;</div><div class="line"></div><div class="line"># define structures</div><div class="line">@structures = [&#39;(((((....)))))&#39;, &#39;(((....)))....&#39;];</div><div class="line"># construct dependency graph with these structures</div><div class="line">$dg = new RNAblueprint::DependencyGraphMT(@structures);</div><div class="line"></div><div class="line"># print this sequence</div><div class="line">print $dg-&gt;get_sequence().&quot;\n&quot;;</div><div class="line"></div><div class="line"># mutate globally for 1000 times and print</div><div class="line">for($i=0; $i&lt;1000; $i++) {</div><div class="line">    $dg-&gt;sample_clocal();</div><div class="line">    print $dg-&gt;get_sequence().&quot;\n&quot;;</div><div class="line">    # revert to the previous sequence</div><div class="line">    $dg-&gt;revert_sequence();</div><div class="line">}</div><div class="line"># print the amount of solutions</div><div class="line">print &#39;Maximal number of solutions: &#39;.$dg-&gt;number_of_sequences().&quot;\n&quot;;</div><div class="line"># print the amount of connected components</div><div class="line">print &#39;Number of Connected Components: &#39;.$dg-&gt;number_of_connected_components().&quot;\n&quot;;</div><div class="line"></div><div class="line"># make a deep copy of the dependency graph</div><div class="line">$dg1 = new RNAblueprint::DependencyGraphMT($dg)</div></div><!-- fragment --> <h2><a class="anchor" id="cpp_ex"></a>
C++ example</h2>
<div class="fragment"><div class="line"></div><div class="line"><span class="comment">// include standard library parts</span></div><div class="line"><span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;exception&gt;</span></div><div class="line"></div><div class="line"><span class="comment">// include RNA header</span></div><div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div><div class="line"><span class="preprocessor">    #include &quot;ViennaRNA/fold.h&quot;</span></div><div class="line"><span class="preprocessor">    #include &quot;ViennaRNA/part_func.h&quot;</span></div><div class="line">}</div><div class="line"><span class="comment">// include RNAblueprint</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="RNAblueprint_8h.html">RNAblueprint.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="comment">// typedefs</span></div><div class="line"></div><div class="line"><span class="comment">// functions</span></div><div class="line"><span class="keywordtype">float</span> energy_of_structure(std::string&amp; sequence, std::string&amp; structure) {</div><div class="line">    <span class="keywordtype">float</span> energy = energy_of_structure(sequence.c_str(), structure.c_str(), 0);</div><div class="line">    <span class="keywordflow">return</span> energy;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">float</span> fold(std::string&amp; sequence, std::string&amp; structure) {</div><div class="line">    <span class="keywordtype">char</span>* structure_cstr = <span class="keyword">new</span> <span class="keywordtype">char</span>[sequence.length()+1];</div><div class="line">    <span class="keywordtype">float</span> energy = fold(sequence.c_str(), structure_cstr);</div><div class="line">    structure = structure_cstr;</div><div class="line">    <span class="keyword">delete</span> structure_cstr;</div><div class="line">    <span class="keywordflow">return</span> energy;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keywordtype">float</span> pf_fold(std::string&amp; sequence, std::string&amp; structure) {</div><div class="line">    <span class="keywordtype">char</span>* structure_cstr = <span class="keyword">new</span> <span class="keywordtype">char</span>[sequence.size()+1];</div><div class="line">    <span class="keywordtype">float</span> energy = pf_fold(sequence.c_str(), structure_cstr);</div><div class="line">    structure = structure_cstr;</div><div class="line">    <span class="keyword">delete</span> structure_cstr;</div><div class="line">    <span class="keywordflow">return</span> energy;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//objective function: 1/3 * eos(1)+eos(2)+eos(3) - 3 * gibbs + 0.5 * 1/3 * (|eos(1)-eos(2)| + |eos(1)-eos(3)| + |eos(2)-eos(3)|)</span></div><div class="line"><span class="keywordtype">float</span> objective_function(std::string&amp; sequence, std::vector&lt;std::string&gt;&amp; structures) {</div><div class="line">    <span class="keywordtype">int</span> M = structures.size();</div><div class="line">    std::vector&lt;float&gt; eos;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : structures) {</div><div class="line">        eos.push_back(energy_of_structure(sequence, s));</div><div class="line">    }</div><div class="line">    std::string pf_fold_struct;</div><div class="line">    <span class="keywordtype">float</span> gibbs = pf_fold(sequence, pf_fold_struct);</div><div class="line">    </div><div class="line">    <span class="keywordtype">float</span> objective_difference_part = 0.0;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i &lt; eos.size(); i++) {</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=i+1; j &lt; eos.size(); j++) {</div><div class="line">            objective_difference_part += abs(eos[i] - eos[j]);</div><div class="line">        }</div><div class="line">    }</div><div class="line">    <span class="keywordtype">float</span> eos_sum = 0;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n : eos)</div><div class="line">        eos_sum += n;</div><div class="line">    </div><div class="line">    <span class="keywordflow">return</span> 1/M * (eos_sum - M * gibbs) + 0.5 * 2/(M * (M-1)) * objective_difference_part;</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// main program starts here</span></div><div class="line"><span class="keywordtype">int</span> main () {</div><div class="line">    </div><div class="line">    std::vector&lt;std::string&gt; structures;</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Input structures in dot-bracket (end with empty line): &quot;</span> &lt;&lt; std::endl;</div><div class="line">    <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div><div class="line">        std::string structure;</div><div class="line">        std::getline(std::cin, structure);</div><div class="line">        <span class="keywordflow">if</span> (structure.empty())</div><div class="line">            <span class="keywordflow">break</span>;</div><div class="line">        <span class="keywordflow">else</span></div><div class="line">            structures.push_back(structure);</div><div class="line">    }</div><div class="line">    </div><div class="line">    <a class="code" href="classdesign_1_1DependencyGraph.html">design::DependencyGraph&lt;std::mt19937&gt;</a> * dependency_graph = NULL;</div><div class="line">    <span class="keywordflow">try</span> {</div><div class="line">        dependency_graph = <span class="keyword">new</span> <a class="code" href="classdesign_1_1DependencyGraph.html">design::DependencyGraph&lt;std::mt19937&gt;</a>(structures);</div><div class="line">    } <span class="keywordflow">catch</span> (std::exception&amp; e) {</div><div class="line">        std::cout &lt;&lt; <span class="stringliteral">&quot;ERROR: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div><div class="line">        exit (EXIT_FAILURE);</div><div class="line">    }</div><div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Number of Sequences: &quot;</span> &lt;&lt; dependency_graph-&gt;<a class="code" href="classdesign_1_1DependencyGraph.html#a3323daeef3c83acb50d2caa5718401d5">number_of_sequences</a>() &lt;&lt; std::endl;</div><div class="line">    <span class="comment">//std::cout &lt;&lt; &quot;Graph: &quot; &lt;&lt; dependency_graph-&gt;get_graphml() &lt;&lt; std::endl;</span></div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n=0; n&lt;10; n++) {</div><div class="line">        dependency_graph-&gt;<a class="code" href="classdesign_1_1DependencyGraph.html#a535101494526f22fdc7f049144fe962e">sample</a>();</div><div class="line">        std::string result_sequence = dependency_graph-&gt;<a class="code" href="classdesign_1_1DependencyGraph.html#a214f172251f252e0b422e858f0ef1a38">get_sequence</a>();</div><div class="line">        <span class="keywordtype">float</span> score = objective_function(result_sequence, structures);</div><div class="line">    </div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i&lt;10000; i++) {</div><div class="line">            dependency_graph-&gt;<a class="code" href="classdesign_1_1DependencyGraph.html#a25c6f862884b192aec61394826359162">sample_clocal</a>();</div><div class="line">            std::string current_sequence = dependency_graph-&gt;<a class="code" href="classdesign_1_1DependencyGraph.html#a214f172251f252e0b422e858f0ef1a38">get_sequence</a>();</div><div class="line">            <span class="keywordtype">float</span> this_score = objective_function(current_sequence, structures);</div><div class="line">            </div><div class="line">            <span class="keywordflow">if</span> (this_score &lt; score) {</div><div class="line">                score = this_score;</div><div class="line">                result_sequence = current_sequence;</div><div class="line">            } <span class="keywordflow">else</span> {</div><div class="line">                dependency_graph-&gt;<a class="code" href="classdesign_1_1DependencyGraph.html#aca5c3c400f0008e440e49afa7da36567">revert_sequence</a>();</div><div class="line">            }</div><div class="line">        }</div><div class="line">        std::cout &lt;&lt; result_sequence &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; score &lt;&lt; std::endl;</div><div class="line">    }</div><div class="line">    exit (EXIT_SUCCESS);</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="testing_sec"></a>
Testing</h1>
<p>Unit tests are available for many functions of the library. Please call <code>make check</code> to run these tests!</p>
<h1><a class="anchor" id="cite_sec"></a>
How to cite</h1>
<p>Stefan Hammer, Birgit Tschiatschek, Christoph Flamm, Ivo L. Hofacker, and Sven Findeiß. “RNAblueprint: Flexible Multiple Target Nucleic Acid Sequence Design.” Bioinformatics, 2017. doi:<a href="http://dx.doi.org/10.1093/bioinformatics/btx263">10.1093/bioinformatics/btx263</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
